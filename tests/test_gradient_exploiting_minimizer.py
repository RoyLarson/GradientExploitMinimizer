
import numpy as np
import pytest

from gradient_exploit_minimizer import Minimizer
from .functions import sleeper, circle_exclusion, plane, offset, paraboloid, egg_holder_function, mpl_toolkits_test_function, approx_grad

@pytest.fixture
def plane_minimizer():
    grad = np.array([2,.5])
    plane = lambda x: plane(*grad, *x)
    bounds = [(-1,2), (2,4)]
    minimizer = Minimizer(plane, grad = lambda x: grad, bounds = bounds)
    return minimizer

def test_minimizer_initilization():
    bounds = [(-1,2), (2,4)]
    minimizer = Minimizer(plane, lambda x:approx_grad(*x, fun=plane), bounds = bounds)
    assert minimizer.bounds ==bounds
    assert minimizer.best_x is None
    assert minimizer.best_min is None

def test_minimizer_bounds_apply_bounds(plane_minimizer):
    minimizer.current_x = np.array([0, 3])
    new_x = minimizer.current_x-plane_minimizer.grad(minimizer.current_x)
    assert new_x[0]<minimizer.bounds[0][0]




